<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.savetrip.DAO.visit.VisitDAO">
    <resultMap id="visit" type="com.savetrip.DTO.visit.VisitDTO">
        <result column="visit_no" property="visitNo" />
        <result column="user_no" property="userNo" />
        <result column="ccode" property="ccode" />
        <result column="visit_title" property="visitTitle" />
        <result column="visit_s_date" property="visitSDate"/>
        <result column="visit_e_date" property="visitEDate" />
        <association property="country" column="ccode" javaType="com.savetrip.DTO.country.CountryDTO" select="selectCountry" />
    </resultMap>

    <select id="tripList" parameterType="int" resultMap="visit">
          SELECT *
          FROM visit
          WHERE user_no = #{userNo}
    </select>

    <insert id="createVisit" parameterType="com.savetrip.DTO.visit.VisitDTO"  useGeneratedKeys="true" keyProperty="visitNo" keyColumn="visit_no">
        INSERT INTO visit (
            user_no,
            ccode
        ) VALUES (
            #{userNo},
            #{ccode}
        )
    </insert>

    <select id="selectByVisitNo" parameterType="int" resultMap="visit">
        SELECT *
        FROM visit
        WHERE visit_no = #{visitNo}
    </select>

    <select id="selectCountry"  resultType="com.savetrip.DTO.country.CountryDTO">
       SELECT *
       FROM country
       WHERE ccode = #{ccode}
    </select>
</mapper>